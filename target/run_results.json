{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-14T17:11:14.510338Z", "invocation_id": "f2b247ef-e7a3-4d9e-aa50-1a47c5943ea8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:11.400298Z", "completed_at": "2025-02-14T17:11:11.428007Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:11.428642Z", "completed_at": "2025-02-14T17:11:12.753753Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3734877109527588, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "5a0d0fe9-d049-431e-8779-9fd800eca87b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.orders_with_prods", "compiled": true, "compiled_code": "WITH orders_with_products AS (\n    SELECT \n        o.orders_id,\n        o.date_date,\n        COUNT(DISTINCT s.products_id) as qty_product\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders` o\n    LEFT JOIN `salesanalysis-450811`.`salesAnalysis`.`sales` s\n        ON o.orders_id = s.order_id\n    WHERE EXTRACT(YEAR FROM o.date_date) IN (2022, 2023)\n    GROUP BY o.orders_id, o.date_date\n)\n\nSELECT \n    orders_id,\n    date_date,\n    qty_product\nFROM orders_with_products\nORDER BY date_date, orders_id", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`orders_with_prods`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:11.394875Z", "completed_at": "2025-02-14T17:11:11.428218Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:11.430528Z", "completed_at": "2025-02-14T17:11:12.754360Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3770511150360107, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "e2bfd217-a30e-44bf-97c5-a16a446365e1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.monthly_orders_2023", "compiled": true, "compiled_code": "WITH orders_2023 AS (\n    SELECT \n        orders_id,\n        date_date,\n        EXTRACT(MONTH FROM date_date) as month\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders`\n    WHERE EXTRACT(YEAR FROM date_date) = 2023\n)\n\nSELECT \n    month,\n    COUNT(DISTINCT orders_id) as orders_count\nFROM orders_2023 \nGROUP BY month\nORDER BY month", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`monthly_orders_2023`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:11.397621Z", "completed_at": "2025-02-14T17:11:11.416048Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:11.422770Z", "completed_at": "2025-02-14T17:11:12.756764Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3775291442871094, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "cfcdb53e-fff3-48a7-9bf4-1b4ded4d3805", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.order_segments_2023", "compiled": true, "compiled_code": "WITH customer_order_counts AS (\n    -- Count previous orders for each customer in the 12 months before each 2023 order\n    SELECT \n        o2023.orders_id,\n        o2023.date_date,\n        o2023.customers_id,\n        COUNT(DISTINCT prev_orders.orders_id) as previous_orders_12m\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders` o2023\n    LEFT JOIN `salesanalysis-450811`.`salesAnalysis`.`orders` prev_orders\n        ON o2023.customers_id = prev_orders.customers_id\n        AND prev_orders.date_date BETWEEN \n            DATE_SUB(o2023.date_date, INTERVAL 12 MONTH) \n            AND DATE_SUB(o2023.date_date, INTERVAL 1 DAY)\n    WHERE EXTRACT(YEAR FROM o2023.date_date) = 2023\n    GROUP BY o2023.orders_id, o2023.date_date, o2023.customers_id\n)\n\nSELECT \n    orders_id,\n    date_date,\n    CASE \n        WHEN previous_orders_12m = 0 THEN 'New'\n        WHEN previous_orders_12m BETWEEN 1 AND 3 THEN 'Returning'\n        WHEN previous_orders_12m >= 4 THEN 'VIP'\n    END as segment\nFROM customer_order_counts\nORDER BY date_date, orders_id", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`order_segments_2023`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:11.382836Z", "completed_at": "2025-02-14T17:11:11.403005Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:11.403415Z", "completed_at": "2025-02-14T17:11:12.759505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3803520202636719, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "e8780818-6a37-4c90-bf8a-0e037e3bb585", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.avg_prods_per_order_2023", "compiled": true, "compiled_code": "WITH order_products AS (\n    SELECT \n        o.orders_id,\n        o.date_date,\n        EXTRACT(MONTH FROM o.date_date) as month,\n        COUNT(DISTINCT s.products_id) as products_count\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders` o\n    LEFT JOIN `salesanalysis-450811`.`salesAnalysis`.`sales` s\n        ON o.orders_id = s.order_id\n    WHERE EXTRACT(YEAR FROM o.date_date) = 2023\n    GROUP BY o.orders_id, o.date_date\n)\n\nSELECT \n    month,\n    ROUND(AVG(products_count), 2) as avg_products_per_order\nFROM order_products\nGROUP BY month\nORDER BY month", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`avg_prods_per_order_2023`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:12.765708Z", "completed_at": "2025-02-14T17:11:12.770118Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:12.770307Z", "completed_at": "2025-02-14T17:11:14.098735Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3352911472320557, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "5279efac-756a-499b-91e6-c72cabe5c40e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.total_orders_2023", "compiled": true, "compiled_code": "WITH orders_2023 AS (\n    SELECT \n        orders_id,\n        date_date\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders`\n    WHERE EXTRACT(YEAR FROM date_date) = 2023\n)\n\nSELECT \n    COUNT(DISTINCT orders_id) as total_orders_2023\nFROM orders_2023", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`total_orders_2023`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T17:11:12.767888Z", "completed_at": "2025-02-14T17:11:12.771890Z"}, {"name": "execute", "started_at": "2025-02-14T17:11:12.772214Z", "completed_at": "2025-02-14T17:11:14.502110Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7386119365692139, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "salesanalysis-450811", "job_id": "4615e898-65d3-420b-8ab8-c58bfd3a01a4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.salesAnalysis.2023_orders_with_segments", "compiled": true, "compiled_code": "WITH orders_2023 AS (\n    SELECT \n        o.orders_id,\n        o.date_date,\n        o.customers_id,\n        COUNT(DISTINCT s.products_id) as qty_products\n    FROM `salesanalysis-450811`.`salesAnalysis`.`orders` o\n    LEFT JOIN `salesanalysis-450811`.`salesAnalysis`.`sales` s\n        ON o.orders_id = s.order_id\n    WHERE EXTRACT(YEAR FROM o.date_date) = 2023\n    GROUP BY o.orders_id, o.date_date, o.customers_id\n)\n\nSELECT \n    o.orders_id,\n    o.date_date,\n    o.qty_products,\n    seg.segment\nFROM orders_2023 o\nLEFT JOIN `salesanalysis-450811`.`sales_analysis`.`order_segments_2023` seg\n    ON o.orders_id = seg.orders_id\nORDER BY o.date_date, o.orders_id", "relation_name": "`salesanalysis-450811`.`sales_analysis`.`2023_orders_with_segments`", "batch_results": null}], "elapsed_time": 6.709869861602783, "args": {"source_freshness_run_project_hooks": false, "log_level": "info", "indirect_selection": "eager", "log_level_file": "debug", "exclude": [], "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "require_resource_names_without_spaces": false, "cache_selected_only": false, "print": true, "log_format": "default", "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "select": [], "state_modified_compare_vars": false, "defer": false, "profiles_dir": "/Users/edou/.dbt", "which": "run", "use_colors": true, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "strict_mode": false, "version_check": true, "write_json": true, "static_parser": true, "empty": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_path": "/Users/edou/Documents/Personal/Internships/Astrafy/TakeHomeAssignment/code/salesAnalysis/logs", "vars": {}, "invocation_command": "dbt run", "require_nested_cumulative_type_params": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "favor_state": false, "introspect": true, "log_format_file": "debug", "project_dir": "/Users/edou/Documents/Personal/Internships/Astrafy/TakeHomeAssignment/code/salesAnalysis", "show_resource_report": false, "macro_debugging": false, "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "skip_nodes_if_on_run_start_fails": false}}